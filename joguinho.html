<html>

	<head>	
	
		<title>
			Joguinho...
		</title>
		
	</head>
	
	<body>
		
		<canvas id="gameCanvas" width="800" height="600"></canvas>
		
		<script>
		//declarando variaveis de canvas
		var canvas;
		var canvasContext;
		
		//declarando variaveis para a bola
		var bolaTamanhoX=10;
		var bolaTamanhoY=10;
		var bolaX = 395;
		var bolaY = 295;
		var bolaVelocidadeX = 1;
		var bolaVelocidadeY = -1;
		
		//declarando variaveis para divisoria do campo
 		var divX = 4;
		var divY = 0;
		
		//declarando variaveis para "raquetes"
		var raqX = 10;
		var raqY = 100;
		var raqPositionX=0;
		var raqPositionY=0;
		
		//declarando variavel para controle de FPS
		var framesPorSegundo =120;
		
		
		
		//retorna posicao do mouse independente da tela
		function posicaoDoMouse(evt)
		{
			
			var retanguloBase = canvas.getBoundingClientRect();
			var pagina = document.documentElement;
			var mouseX = evt.clientX - retanguloBase.left -  pagina.scrollLeft;
			var mouseY = evt.clientY - retanguloBase.top -  pagina.scrollTop;
			return{
			x:mouseX,
			y:mouseY
			};
			
			
		}
		
		//dispara apos carregar todo conteudo da pagina
		window.onload = function()
		{
			//testando console
			console.log("Carregando jogo");
			
			//setando canvas pelo id e variaveis de outro escopo
			canvas = document.getElementById('gameCanvas');
			divY = canvas.height;
			raqPositionX = 10;
			raqPositiony = (canvas.height/2)-(raqY/2);
			
			//setando tipo de canvas
			canvasContext = canvas.getContext('2d');
			
			//desenhando tela e movendo pela funcao DesenhaEMove (1000 = 1seg)
			setInterval(DesenhaEMove, 1000/framesPorSegundo);
			
			//captura e atualiza posicao da raquete no eixo y
			canvas.addEventListener('mousemove',
			function(evt){
				var mousePos = posicaoDoMouse(evt); 
				raqPositionY = mousePos.y;;
			});
			
		}
		
		//uniao das funcoes de deenhar e mover
		function DesenhaEMove()
		{
			desenhaNaTela();
			movimentaObjetos();
			
		}
		
		//funcao para desenhar os objetos usando um template
		function desenhaNaTela()
		{			
			
			//desenhando fundo preto e definindo posicao
			criaImagemTemplate(0,0,canvas.width,canvas.height,'black');
	
			//desenhando linha divvisoria do campo dos jogadores. cor verde
			criaImagemTemplate((canvas.width/2)-(divX/2),0,divX,divY,'#00cc00');
			
			//desenhando p1 "raquete" cor verde esquerda
			criaImagemTemplate(raqPositionX,raqPositionY,raqX,raqY,'#00cc00');
			
			//desenhando a "bola"
			//quadrada: 
			//		criaImagemTemplate(bolaX,bolaY,bolaTamanhoX,bolaTamanhoY,'white');
			//redonda:
					criaCirculoTemplate(bolaX,bolaY,10, 100, true, 'white')
			
		}
		
		//funcao que determina o movimento dos objetos
		function movimentaObjetos()
		{
		
			//checando posicao da bola para entao alterar sua direcao
			if(bolaX > canvas.width-bolaTamanhoX || bolaX< 10)
			{
				bolaVelocidadeX = bolaVelocidadeX*-1;
			}
			if(bolaY > canvas.height-bolaTamanhoY || bolaY< 10)
			{
				bolaVelocidadeY = bolaVelocidadeY*-1;
			}
			
			
			//teste bola movimento em x e y
			bolaX = bolaX + bolaVelocidadeX;
			bolaY = bolaY + bolaVelocidadeY;
		}
		
		//funcao que funciona como template para criar obetos e assim melhorar a legibilidade do codigo
		function criaImagemTemplate(esquerdaX,topoY, largura, altura, cor)
		{
			canvasContext.fillStyle = cor;
			canvasContext.fillRect(esquerdaX,topoY,largura,altura);
		}
		
		//funcao que funciona como template para criar circulos e assim melhorar a legibilidade do codigo
		function criaCirculoTemplate(posicaoX,posicaoY,raio, porcentagem, bool, cor)
		{
			canvasContext.fillStyle = cor;
			canvasContext.beginPath();
			canvasContext.arc(posicaoX,posicaoY,raio,porcentagem,Math.PI*2, bool,cor);
			canvasContext.fill();
		}
		
		
		</script>
		
	</body>

</html>
